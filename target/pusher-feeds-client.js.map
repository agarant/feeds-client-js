{"version":3,"file":"pusher-feeds-client.js","sources":["../node_modules/pusher-platform-js/target/pusher-platform.js","../src/constants.js","../src/utils.js","../src/feed.js","../src/token-provider.js","../src/feeds.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"PusherPlatform\"] = factory();\n\telse\n\t\troot[\"PusherPlatform\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 6);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar subscription_1 = __webpack_require__(2);\nvar resumable_subscription_1 = __webpack_require__(3);\nfunction responseHeadersObj(headerStr) {\n    var headers = {};\n    if (!headerStr) {\n        return headers;\n    }\n    var headerPairs = headerStr.split('\\u000d\\u000a');\n    for (var i = 0; i < headerPairs.length; i++) {\n        var headerPair = headerPairs[i];\n        var index = headerPair.indexOf('\\u003a\\u0020');\n        if (index > 0) {\n            var key = headerPair.substring(0, index);\n            var val = headerPair.substring(index + 2);\n            headers[key] = val;\n        }\n    }\n    return headers;\n}\nexports.responseHeadersObj = responseHeadersObj;\nvar ErrorResponse = (function (_super) {\n    __extends(ErrorResponse, _super);\n    function ErrorResponse(statusCode, headers, info) {\n        var _this = _super.call(this, \"ErroResponse: \" + statusCode + \": \" + info + \" \\n Headers: \" + JSON.stringify(headers)) || this;\n        _this.statusCode = statusCode;\n        _this.headers = headers;\n        _this.info = info;\n        return _this;\n    }\n    ErrorResponse.fromXHR = function (xhr) {\n        return new ErrorResponse(xhr.status, responseHeadersObj(xhr.getAllResponseHeaders()), xhr.responseText);\n    };\n    return ErrorResponse;\n}(Error));\nexports.ErrorResponse = ErrorResponse;\nvar NetworkError = (function (_super) {\n    __extends(NetworkError, _super);\n    function NetworkError(error) {\n        var _this = _super.call(this, error) || this;\n        Object.setPrototypeOf(_this, NetworkError.prototype);\n        _this.error = error;\n        return _this;\n    }\n    return NetworkError;\n}(Error));\nexports.NetworkError = NetworkError;\n// Follows https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/readyState\nvar XhrReadyState;\n(function (XhrReadyState) {\n    XhrReadyState[XhrReadyState[\"UNSENT\"] = 0] = \"UNSENT\";\n    XhrReadyState[XhrReadyState[\"OPENED\"] = 1] = \"OPENED\";\n    XhrReadyState[XhrReadyState[\"HEADERS_RECEIVED\"] = 2] = \"HEADERS_RECEIVED\";\n    XhrReadyState[XhrReadyState[\"LOADING\"] = 3] = \"LOADING\";\n    XhrReadyState[XhrReadyState[\"DONE\"] = 4] = \"DONE\";\n})(XhrReadyState = exports.XhrReadyState || (exports.XhrReadyState = {}));\nvar BaseClient = (function () {\n    function BaseClient(options) {\n        this.options = options;\n        var cluster = options.cluster.replace(/\\/$/, '');\n        this.baseURL = (options.encrypted !== false ? \"https\" : \"http\") + \"://\" + cluster;\n        this.XMLHttpRequest = options.XMLHttpRequest || window.XMLHttpRequest;\n    }\n    BaseClient.prototype.request = function (options) {\n        var xhr = this.createXHR(this.baseURL, options);\n        return new Promise(function (resolve, reject) {\n            xhr.onreadystatechange = function () {\n                if (xhr.readyState === 4) {\n                    if (xhr.status === 200) {\n                        resolve(xhr.responseText);\n                    }\n                    else {\n                        reject(ErrorResponse.fromXHR(xhr));\n                    }\n                }\n            };\n            xhr.send(JSON.stringify(options.body));\n        });\n    };\n    BaseClient.prototype.newSubscription = function (subOptions) {\n        return new subscription_1.Subscription(this.createXHR(this.baseURL, {\n            method: \"SUBSCRIBE\",\n            path: subOptions.path,\n            headers: {},\n            body: null,\n        }), subOptions);\n    };\n    BaseClient.prototype.newResumableSubscription = function (subOptions) {\n        var _this = this;\n        return new resumable_subscription_1.ResumableSubscription(function () {\n            return _this.createXHR(_this.baseURL, {\n                method: \"SUBSCRIBE\",\n                path: subOptions.path,\n                headers: {},\n                body: null,\n            });\n        }, subOptions);\n    };\n    BaseClient.prototype.createXHR = function (baseURL, options) {\n        var XMLHttpRequest = this.XMLHttpRequest;\n        var xhr = new XMLHttpRequest();\n        var path = options.path.replace(/^\\/+/, \"\");\n        var endpoint = baseURL + \"/\" + path;\n        xhr.open(options.method.toUpperCase(), endpoint, true);\n        if (options.body) {\n            xhr.setRequestHeader(\"content-type\", \"application/json\");\n        }\n        if (options.jwt) {\n            xhr.setRequestHeader(\"authorization\", \"Bearer \" + options.jwt);\n        }\n        for (var key in options.headers) {\n            xhr.setRequestHeader(key, options.headers[key]);\n        }\n        return xhr;\n    };\n    return BaseClient;\n}());\nexports.BaseClient = BaseClient;\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar LogLevel;\n(function (LogLevel) {\n    LogLevel[LogLevel[\"VERBOSE\"] = 1] = \"VERBOSE\";\n    LogLevel[LogLevel[\"DEBUG\"] = 2] = \"DEBUG\";\n    LogLevel[LogLevel[\"INFO\"] = 3] = \"INFO\";\n    LogLevel[LogLevel[\"WARNING\"] = 4] = \"WARNING\";\n    LogLevel[LogLevel[\"ERROR\"] = 5] = \"ERROR\";\n})(LogLevel = exports.LogLevel || (exports.LogLevel = {}));\n/**\n * Default implementation of the Logger. Wraps standards console calls.\n * Logs only calls that are at or above the threshold (verbose/debug/info/warn/error)\n * If error is passed, it will append the message to the error object.\n */\nvar ConsoleLogger = (function () {\n    function ConsoleLogger(threshold) {\n        if (threshold === void 0) { threshold = 2; }\n        this.threshold = threshold;\n    }\n    ConsoleLogger.prototype.log = function (logFunction, level, message, error) {\n        if (level >= this.threshold) {\n            var loggerSignature = \"Logger.\" + LogLevel[level];\n            if (error) {\n                console.group();\n                logFunction(loggerSignature + \": \" + message);\n                logFunction(error);\n                console.groupEnd();\n            }\n            else {\n                logFunction(loggerSignature + \": \" + message);\n            }\n        }\n    };\n    ConsoleLogger.prototype.verbose = function (message, error) {\n        this.log(console.log, LogLevel.VERBOSE, message, error);\n    };\n    ConsoleLogger.prototype.debug = function (message, error) {\n        this.log(console.log, LogLevel.DEBUG, message, error);\n    };\n    ConsoleLogger.prototype.info = function (message, error) {\n        this.log(console.info, LogLevel.INFO, message, error);\n    };\n    ConsoleLogger.prototype.warn = function (message, error) {\n        this.log(console.warn, LogLevel.WARNING, message, error);\n    };\n    ConsoleLogger.prototype.error = function (message, error) {\n        this.log(console.error, LogLevel.ERROR, message, error);\n    };\n    return ConsoleLogger;\n}());\nexports.ConsoleLogger = ConsoleLogger;\nvar EmptyLogger = (function () {\n    function EmptyLogger() {\n    }\n    EmptyLogger.prototype.verbose = function (message, error) { };\n    ;\n    EmptyLogger.prototype.debug = function (message, error) { };\n    ;\n    EmptyLogger.prototype.info = function (message, error) { };\n    ;\n    EmptyLogger.prototype.warn = function (message, error) { };\n    ;\n    EmptyLogger.prototype.error = function (message, error) { };\n    ;\n    return EmptyLogger;\n}());\nexports.EmptyLogger = EmptyLogger;\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar base_client_1 = __webpack_require__(0);\nvar SubscriptionState;\n(function (SubscriptionState) {\n    SubscriptionState[SubscriptionState[\"UNOPENED\"] = 0] = \"UNOPENED\";\n    SubscriptionState[SubscriptionState[\"OPENING\"] = 1] = \"OPENING\";\n    SubscriptionState[SubscriptionState[\"OPEN\"] = 2] = \"OPEN\";\n    SubscriptionState[SubscriptionState[\"ENDING\"] = 3] = \"ENDING\";\n    SubscriptionState[SubscriptionState[\"ENDED\"] = 4] = \"ENDED\"; // called onEnd() or onError(err)\n})(SubscriptionState = exports.SubscriptionState || (exports.SubscriptionState = {}));\n// Asserts that the subscription state is one of the specified values,\n// otherwise logs the current value.\nfunction assertState(stateEnum, states) {\n    var _this = this;\n    if (states === void 0) { states = []; }\n    var check = states.some(function (state) { return stateEnum[state] === _this.state; });\n    var expected = states.join(', ');\n    var actual = stateEnum[this.state];\n    console.assert(check, \"Expected this.state to be \" + expected + \" but it is \" + actual);\n    if (!check) {\n        console.trace();\n    }\n}\nexports.assertState = assertState;\n;\n// Callback pattern: (onOpen onEvent* (onEnd|onError)) | onError\n// A call to `unsubscribe()` will call `options.onEnd()`;\n// a call to `unsubscribe(someError)` will call `options.onError(someError)`.\nvar Subscription = (function () {\n    function Subscription(xhr, options) {\n        var _this = this;\n        this.xhr = xhr;\n        this.options = options;\n        this.state = SubscriptionState.UNOPENED;\n        this.gotEOS = false;\n        this.lastNewlineIndex = 0;\n        this.assertState = assertState.bind(this, SubscriptionState);\n        if (options.lastEventId) {\n            this.xhr.setRequestHeader(\"Last-Event-Id\", options.lastEventId);\n        }\n        this.xhr.onreadystatechange = function () {\n            if (_this.xhr.readyState === base_client_1.XhrReadyState.UNSENT ||\n                _this.xhr.readyState === base_client_1.XhrReadyState.OPENED ||\n                _this.xhr.readyState === base_client_1.XhrReadyState.HEADERS_RECEIVED) {\n                // Too early for us to do anything.\n                _this.assertState(['OPENING']);\n            }\n            else if (_this.xhr.readyState === base_client_1.XhrReadyState.LOADING) {\n                // The headers have loaded and we have partial body text.\n                // We can get this one multiple times.\n                _this.assertState(['OPENING', 'OPEN', 'ENDING']);\n                if (_this.xhr.status === 200) {\n                    // We've received a successful response header.\n                    // The partial body text is a partial JSON message stream.\n                    if (_this.state === SubscriptionState.OPENING) {\n                        _this.state = SubscriptionState.OPEN;\n                        if (_this.options.onOpen) {\n                            _this.options.onOpen();\n                        }\n                    }\n                    _this.assertState(['OPEN', 'ENDING']);\n                    var err = _this.onChunk(); // might transition our state from OPEN -> ENDING\n                    _this.assertState(['OPEN', 'ENDING']);\n                    if (err != null) {\n                        _this.state = SubscriptionState.ENDED;\n                        if (err.statusCode != 204) {\n                            if (_this.options.onError) {\n                                _this.options.onError(err);\n                            }\n                        }\n                        // Because we abort()ed, we will get no more calls to our onreadystatechange handler,\n                        // and so we will not call the event handler again.\n                        // Finish with options.onError instead of the options.onEnd.\n                    }\n                    else {\n                        // We consumed some response text, and all's fine. We expect more text.\n                    }\n                }\n                else {\n                    // Error response. Wait until the response completes (state 4) before erroring.\n                    _this.assertState(['OPENING']);\n                }\n            }\n            else if (_this.xhr.readyState === base_client_1.XhrReadyState.DONE) {\n                // This is the last time onreadystatechange is called.\n                if (_this.xhr.status === 200) {\n                    if (_this.state === SubscriptionState.OPENING) {\n                        _this.state = SubscriptionState.OPEN;\n                        if (_this.options.onOpen) {\n                            _this.options.onOpen();\n                        }\n                    }\n                    _this.assertState(['OPEN', 'ENDING']);\n                    var err = _this.onChunk();\n                    if (err !== null && err !== undefined) {\n                        _this.state = SubscriptionState.ENDED;\n                        if (err.statusCode === 204) {\n                            if (_this.options.onEnd) {\n                                _this.options.onEnd();\n                            }\n                        }\n                        else {\n                            if (_this.options.onError) {\n                                _this.options.onError(err);\n                            }\n                        }\n                    }\n                    else if (_this.state <= SubscriptionState.ENDING) {\n                        if (_this.options.onError) {\n                            _this.options.onError(new Error(\"HTTP response ended without receiving EOS message\"));\n                        }\n                    }\n                    else {\n                        // Stream ended normally.\n                        if (_this.options.onEnd) {\n                            _this.options.onEnd();\n                        }\n                    }\n                }\n                else {\n                    // The server responded with a bad status code (finish with onError).\n                    // Finish with an error.\n                    _this.assertState(['OPENING', 'OPEN', 'ENDED']);\n                    if (_this.state === SubscriptionState.ENDED) {\n                        // We aborted the request deliberately, and called onError/onEnd elsewhere.\n                    }\n                    else if (_this.xhr.status === 0) {\n                        _this.options.onError(new base_client_1.NetworkError(\"Connection lost.\"));\n                    }\n                    else {\n                        _this.options.onError(base_client_1.ErrorResponse.fromXHR(_this.xhr));\n                    }\n                }\n            }\n        };\n    }\n    Subscription.prototype.open = function (jwt) {\n        if (this.state !== SubscriptionState.UNOPENED) {\n            throw new Error(\"Called .open() on Subscription object in unexpected state: \" + this.state);\n        }\n        this.state = SubscriptionState.OPENING;\n        if (jwt) {\n            this.xhr.setRequestHeader(\"authorization\", \"Bearer \" + jwt);\n        }\n        this.xhr.send();\n    };\n    // calls options.onEvent 0+ times, then possibly returns an error.\n    // idempotent.\n    Subscription.prototype.onChunk = function () {\n        this.assertState(['OPEN']);\n        var response = this.xhr.responseText;\n        var newlineIndex = response.lastIndexOf(\"\\n\");\n        if (newlineIndex > this.lastNewlineIndex) {\n            var rawEvents = response.slice(this.lastNewlineIndex, newlineIndex).split(\"\\n\");\n            this.lastNewlineIndex = newlineIndex;\n            for (var _i = 0, rawEvents_1 = rawEvents; _i < rawEvents_1.length; _i++) {\n                var rawEvent = rawEvents_1[_i];\n                if (rawEvent.length === 0) {\n                    continue; // FIXME why? This should be a protocol error\n                }\n                var data = JSON.parse(rawEvent);\n                var err = this.onMessage(data);\n                if (err != null) {\n                    return err;\n                }\n            }\n        }\n    };\n    // calls options.onEvent 0+ times, then returns an Error or null\n    Subscription.prototype.onMessage = function (message) {\n        this.assertState(['OPEN']);\n        if (this.gotEOS) {\n            return new Error(\"Got another message after EOS message\");\n        }\n        if (!Array.isArray(message)) {\n            return new Error(\"Message is not an array\");\n        }\n        if (message.length < 1) {\n            return new Error(\"Message is empty array\");\n        }\n        switch (message[0]) {\n            case 0:\n                return null;\n            case 1:\n                return this.onEventMessage(message);\n            case 255:\n                return this.onEOSMessage(message);\n            default:\n                return new Error(\"Unknown Message: \" + JSON.stringify(message));\n        }\n    };\n    // EITHER calls options.onEvent, OR returns an error\n    Subscription.prototype.onEventMessage = function (eventMessage) {\n        this.assertState(['OPEN']);\n        if (eventMessage.length !== 4) {\n            return new Error(\"Event message has \" + eventMessage.length + \" elements (expected 4)\");\n        }\n        var _ = eventMessage[0], id = eventMessage[1], headers = eventMessage[2], body = eventMessage[3];\n        if (typeof id !== \"string\") {\n            return new Error(\"Invalid event ID in message: \" + JSON.stringify(eventMessage));\n        }\n        if (typeof headers !== \"object\" || Array.isArray(headers)) {\n            return new Error(\"Invalid event headers in message: \" + JSON.stringify(eventMessage));\n        }\n        if (this.options.onEvent) {\n            this.options.onEvent({ eventId: id, headers: headers, body: body });\n        }\n    };\n    // calls options.onEvent 0+ times, then possibly returns an error\n    Subscription.prototype.onEOSMessage = function (eosMessage) {\n        this.assertState(['OPEN']);\n        if (eosMessage.length !== 4) {\n            return new Error(\"EOS message has \" + eosMessage.length + \" elements (expected 4)\");\n        }\n        var _ = eosMessage[0], statusCode = eosMessage[1], headers = eosMessage[2], info = eosMessage[3];\n        if (typeof statusCode !== \"number\") {\n            return new Error(\"Invalid EOS Status Code\");\n        }\n        if (typeof headers !== \"object\" || Array.isArray(headers)) {\n            return new Error(\"Invalid EOS Headers\");\n        }\n        this.state = SubscriptionState.ENDING;\n        return new base_client_1.ErrorResponse(statusCode, headers, info);\n    };\n    Subscription.prototype.unsubscribe = function (err) {\n        this.state = SubscriptionState.ENDED;\n        this.xhr.abort();\n        if (err) {\n            if (this.options.onError) {\n                this.options.onError(err);\n            }\n        }\n        else {\n            if (this.options.onEnd) {\n                this.options.onEnd();\n            }\n        }\n    };\n    return Subscription;\n}());\nexports.Subscription = Subscription;\n\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar subscription_1 = __webpack_require__(2);\nvar retry_strategy_1 = __webpack_require__(4);\nvar ResumableSubscriptionState;\n(function (ResumableSubscriptionState) {\n    ResumableSubscriptionState[ResumableSubscriptionState[\"UNOPENED\"] = 0] = \"UNOPENED\";\n    ResumableSubscriptionState[ResumableSubscriptionState[\"OPENING\"] = 1] = \"OPENING\";\n    ResumableSubscriptionState[ResumableSubscriptionState[\"OPEN\"] = 2] = \"OPEN\";\n    ResumableSubscriptionState[ResumableSubscriptionState[\"ENDING\"] = 3] = \"ENDING\";\n    ResumableSubscriptionState[ResumableSubscriptionState[\"ENDED\"] = 4] = \"ENDED\"; // called onEnd() or onError(err)\n})(ResumableSubscriptionState = exports.ResumableSubscriptionState || (exports.ResumableSubscriptionState = {}));\n// Asserts that the subscription state is one of the specified values,\n// otherwise logs the current value.\nfunction assertState(stateEnum, states) {\n    var _this = this;\n    if (states === void 0) { states = []; }\n    var check = states.some(function (state) { return stateEnum[state] === _this.state; });\n    var expected = states.join(', ');\n    var actual = stateEnum[this.state];\n    console.assert(check, \"Expected this.state to be \" + expected + \" but it is \" + actual);\n    if (!check) {\n        console.trace();\n    }\n}\nexports.assertState = assertState;\n;\n// pattern of callbacks: ((onOpening (onOpen onEvent*)?)? (onError|onEnd)) | onError\nvar ResumableSubscription = (function () {\n    function ResumableSubscription(xhrSource, options) {\n        this.xhrSource = xhrSource;\n        this.options = options;\n        this.state = ResumableSubscriptionState.UNOPENED;\n        this.assertState = assertState.bind(this, ResumableSubscriptionState);\n        this.lastEventIdReceived = options.lastEventId;\n        this.logger = options.logger;\n        if (options.retryStrategy !== undefined) {\n            this.retryStrategy = options.retryStrategy;\n        }\n        else {\n            this.retryStrategy = new retry_strategy_1.ExponentialBackoffRetryStrategy({\n                logger: this.logger\n            });\n        }\n    }\n    ResumableSubscription.prototype.tryNow = function () {\n        var _this = this;\n        this.state = ResumableSubscriptionState.OPENING;\n        var newXhr = this.xhrSource();\n        this.subscription = new subscription_1.Subscription(newXhr, {\n            path: this.options.path,\n            lastEventId: this.lastEventIdReceived,\n            onOpen: function () {\n                _this.assertState(['OPENING']);\n                _this.state = ResumableSubscriptionState.OPEN;\n                if (_this.options.onOpen) {\n                    _this.options.onOpen();\n                }\n                _this.retryStrategy.reset(); //We need to reset the counter once the connection has been re-established.\n            },\n            onEvent: function (event) {\n                _this.assertState(['OPEN']);\n                if (_this.options.onEvent) {\n                    _this.options.onEvent(event);\n                }\n                console.assert(!_this.lastEventIdReceived ||\n                    parseInt(event.eventId) > parseInt(_this.lastEventIdReceived), 'Expected the current event id to be larger than the previous one');\n                _this.lastEventIdReceived = event.eventId;\n            },\n            onEnd: function () {\n                _this.state = ResumableSubscriptionState.ENDED;\n                if (_this.options.onEnd) {\n                    _this.options.onEnd();\n                }\n            },\n            onError: function (error) {\n                _this.state = ResumableSubscriptionState.OPENING;\n                _this.retryStrategy.attemptRetry(error)\n                    .then(function () {\n                    if (_this.options.onRetry !== undefined) {\n                        _this.options.onRetry();\n                    }\n                    else {\n                        _this.tryNow();\n                    }\n                })\n                    .catch(function (error) {\n                    _this.state = ResumableSubscriptionState.ENDED;\n                    if (_this.options.onError) {\n                        _this.options.onError(error);\n                    }\n                });\n            },\n            logger: this.logger\n        });\n        if (this.options.tokenProvider) {\n            this.options.tokenProvider.fetchToken().then(function (jwt) {\n                _this.subscription.open(jwt);\n            }).catch(function (err) {\n                if (_this.options.onError)\n                    _this.options.onError(err);\n            });\n        }\n        else {\n            this.subscription.open(null);\n        }\n    };\n    ResumableSubscription.prototype.open = function () {\n        this.tryNow();\n    };\n    ResumableSubscription.prototype.unsubscribe = function (error) {\n        this.subscription.unsubscribe(error); // We'll get onEnd and bubble this up\n    };\n    return ResumableSubscription;\n}());\nexports.ResumableSubscription = ResumableSubscription;\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar base_client_1 = __webpack_require__(0);\nvar logger_1 = __webpack_require__(1);\nvar Retry = (function () {\n    function Retry(waitTimeMilis) {\n        this.waitTimeMilis = waitTimeMilis;\n    }\n    return Retry;\n}());\nexports.Retry = Retry;\nvar DoNotRetry = (function () {\n    function DoNotRetry(error) {\n        this.error = error;\n    }\n    return DoNotRetry;\n}());\nexports.DoNotRetry = DoNotRetry;\nvar ExponentialBackoffRetryStrategy = (function () {\n    function ExponentialBackoffRetryStrategy(options) {\n        this.limit = 6;\n        this.retryCount = 0;\n        this.maxBackoffMilis = 30000;\n        this.defaultBackoffMilis = 1000;\n        this.currentBackoffMilis = this.defaultBackoffMilis;\n        if (options.limit)\n            this.limit = options.limit;\n        if (options.initialBackoffMilis) {\n            this.currentBackoffMilis = options.initialBackoffMilis;\n            this.defaultBackoffMilis = options.defaultBackoffMilis;\n        }\n        if (options.maxBackoffMilis)\n            this.maxBackoffMilis = options.maxBackoffMilis;\n        if (options.logger !== undefined) {\n            this.logger = options.logger;\n        }\n        else {\n            this.logger = new logger_1.EmptyLogger();\n        }\n    }\n    ExponentialBackoffRetryStrategy.prototype.shouldRetry = function (error) {\n        this.logger.verbose(this.constructor.name + \":  Error received\", error);\n        if (this.retryCount >= this.limit && this.limit > 0) {\n            this.logger.verbose(this.constructor.name + \":  Retry count is over the maximum limit: \" + this.limit);\n            return new DoNotRetry(error);\n        }\n        var retryable = this.isRetryable(error);\n        if (retryable.isRetryable) {\n            if (retryable.backoffMillis) {\n                this.retryCount += 1;\n                return new Retry(retryable.backoffMillis);\n            }\n            else {\n                this.currentBackoffMilis = this.calulateMilisToRetry();\n                this.retryCount += 1;\n                this.logger.verbose(this.constructor.name + \": Will attempt to retry in: \" + this.currentBackoffMilis);\n                return new Retry(this.currentBackoffMilis);\n            }\n        }\n        else {\n            this.logger.verbose(this.constructor.name + \": Error is not retryable\", error);\n            return new DoNotRetry(error);\n        }\n    };\n    ExponentialBackoffRetryStrategy.prototype.attemptRetry = function (error) {\n        var _this = this;\n        return new Promise(function (resolve, reject) {\n            var shouldRetry = _this.shouldRetry(error);\n            if (shouldRetry instanceof DoNotRetry) {\n                reject(error);\n            }\n            else if (shouldRetry instanceof Retry) {\n                window.setTimeout(resolve, shouldRetry.waitTimeMilis);\n            }\n        });\n    };\n    ExponentialBackoffRetryStrategy.prototype.isRetryable = function (error) {\n        var retryable = {\n            isRetryable: false\n        };\n        //We allow network errors\n        if (error instanceof base_client_1.NetworkError)\n            retryable.isRetryable = true;\n        else if (error instanceof base_client_1.ErrorResponse) {\n            //Only retry after is allowed\n            if (error.headers[\"retry-after\"]) {\n                retryable.isRetryable = true;\n                retryable.backoffMillis = parseInt(error.headers[\"retry-after\"]) * 1000;\n            }\n        }\n        return retryable;\n    };\n    ExponentialBackoffRetryStrategy.prototype.reset = function () {\n        this.retryCount = 0;\n        this.currentBackoffMilis = this.defaultBackoffMilis;\n    };\n    ExponentialBackoffRetryStrategy.prototype.calulateMilisToRetry = function () {\n        if (this.currentBackoffMilis >= this.maxBackoffMilis || this.currentBackoffMilis * 2 >= this.maxBackoffMilis) {\n            return this.maxBackoffMilis;\n        }\n        if (this.retryCount > 0) {\n            return this.currentBackoffMilis * 2;\n        }\n        return this.currentBackoffMilis;\n    };\n    return ExponentialBackoffRetryStrategy;\n}());\nexports.ExponentialBackoffRetryStrategy = ExponentialBackoffRetryStrategy;\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar base_client_1 = __webpack_require__(0);\nvar logger_1 = __webpack_require__(1);\nvar DEFAULT_CLUSTER = \"api-ceres.pusherplatform.io\";\nvar App = (function () {\n    function App(options) {\n        if (!options.serviceId) {\n            throw new Error('Expected `serviceId` property in App options');\n        }\n        this.serviceId = options.serviceId;\n        this.tokenProvider = options.tokenProvider;\n        this.client = options.client || new base_client_1.BaseClient({\n            cluster: options.cluster ?\n                sanitizeCluster(options.cluster) : DEFAULT_CLUSTER,\n            encrypted: options.encrypted\n        });\n        if (options.logger !== undefined) {\n            this.logger = options.logger;\n        }\n        else {\n            this.logger = new logger_1.ConsoleLogger();\n        }\n    }\n    App.prototype.request = function (options) {\n        var _this = this;\n        options.path = this.absPath(options.path);\n        var tokenProvider = options.tokenProvider || this.tokenProvider;\n        if (!options.jwt && tokenProvider) {\n            return tokenProvider.fetchToken().then(function (jwt) {\n                return _this.client.request(__assign({ jwt: jwt }, options));\n            });\n        }\n        else {\n            return this.client.request(options);\n        }\n    };\n    App.prototype.subscribe = function (options) {\n        options.path = this.absPath(options.path);\n        options.logger = this.logger;\n        var subscription = this.client.newSubscription(options);\n        var tokenProvider = options.tokenProvider || this.tokenProvider;\n        if (options.jwt) {\n            subscription.open(options.jwt);\n        }\n        else if (tokenProvider) {\n            tokenProvider.fetchToken().then(function (jwt) {\n                subscription.open(jwt);\n            }).catch(function (err) {\n                subscription.unsubscribe(err);\n            });\n        }\n        else {\n            subscription.open(null);\n        }\n        return subscription;\n    };\n    App.prototype.resumableSubscribe = function (options) {\n        if (!options.logger)\n            options.logger = this.logger;\n        options.logger = this.logger;\n        options.path = this.absPath(options.path);\n        var tokenProvider = options.tokenProvider || this.tokenProvider;\n        var resumableSubscription = this.client.newResumableSubscription(__assign({ tokenProvider: tokenProvider }, options));\n        resumableSubscription.open();\n        return resumableSubscription;\n    };\n    App.prototype.absPath = function (relativePath) {\n        return (\"/apps/\" + this.serviceId + \"/\" + relativePath).replace(/\\/+/g, \"/\").replace(/\\/+$/, \"\");\n    };\n    return App;\n}());\nexports.default = App;\nfunction sanitizeCluster(cluster) {\n    return cluster\n        .replace(/^[^\\/:]*:\\/\\//, \"\") // remove schema\n        .replace(/\\/$/, \"\"); // remove trailing slash\n}\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar app_1 = __webpack_require__(5);\nexports.App = app_1.default;\nvar base_client_1 = __webpack_require__(0);\nexports.BaseClient = base_client_1.BaseClient;\nvar logger_1 = __webpack_require__(1);\nexports.ConsoleLogger = logger_1.ConsoleLogger;\nexports.EmptyLogger = logger_1.EmptyLogger;\nvar resumable_subscription_1 = __webpack_require__(3);\nexports.ResumableSubscription = resumable_subscription_1.ResumableSubscription;\nvar retry_strategy_1 = __webpack_require__(4);\nexports.ExponentialBackoffRetryStrategy = retry_strategy_1.ExponentialBackoffRetryStrategy;\nvar subscription_1 = __webpack_require__(2);\nexports.Subscription = subscription_1.Subscription;\nexports.default = {\n    App: app_1.default,\n    BaseClient: base_client_1.BaseClient,\n    ResumableSubscription: resumable_subscription_1.ResumableSubscription, Subscription: subscription_1.Subscription,\n    ExponentialBackoffRetryStrategy: retry_strategy_1.ExponentialBackoffRetryStrategy,\n    ConsoleLogger: logger_1.ConsoleLogger, EmptyLogger: logger_1.EmptyLogger\n};\n\n\n/***/ })\n/******/ ]);\n});","export const cacheExpiryTolerance = 10 * 60; // 10 minutes (in seconds)\nexport const defaultAuthEndpoint = \"/feeds/tokens\";\nexport const feedIdRegex = /^[a-zA-Z0-9-]+$/;\nexport const serviceIdRegex = /^[a-zA-Z0-9-]+$/;\nexport const servicePath = \"services/feeds/v1\";\nexport const tokenProviderTimeout = 30 * 1000; // 30 seconds (in ms)\n","export function parseResponse(promise) {\n  return new Promise((resolve, reject) => {\n    promise.then(response => {\n      try {\n        resolve(JSON.parse(response));\n      } catch (err) {\n        reject(err);\n      }\n    }).catch(reject);\n  });\n}\n\nexport function urlEncode(data) {\n  return Object.keys(data)\n    .filter(key => data[key] !== undefined)\n    .map(key => `${ key }=${ encodeURIComponent(data[key]) }`)\n    .join(\"&\");\n}\n\nexport function queryString(data) {\n  const encodedData = urlEncode(data);\n  return encodedData ? `?${ encodedData }` : \"\";\n}\n\nexport function unixTimeNow() {\n  return Math.floor(Date.now() / 1000);\n}\n","import { servicePath } from \"./constants\";\nimport { parseResponse, queryString } from \"./utils\";\n\nexport default class Feed {\n  constructor({ app, feedId, readTokenProvider }) {\n    this.app = app;\n    this.feedId = feedId;\n    this.readTokenProvider = readTokenProvider;\n  }\n\n  subscribe(options = {}) {\n    if (typeof options.onItem !== \"function\") {\n      throw new TypeError(\"Must provide an `onItem` callback\");\n    }\n    return this.app.resumableSubscribe({\n      ...options,\n      path: this.itemsPath + queryString({\n        tail_size: options.tailSize,\n      }),\n      tokenProvider: this.readTokenProvider,\n      onEvent: options.onItem,\n    });\n  }\n\n  getHistory({ fromId, limit = 50 } = {}) {\n    return parseResponse(this.app.request({\n      method: \"GET\",\n      path: this.itemsPath + queryString({\n        from_id: fromId,\n        limit: limit,\n      }),\n      tokenProvider: this.readTokenProvider,\n    }));\n  }\n\n  get itemsPath() {\n    return `${ servicePath }/feeds/${ this.feedId }/items`;\n  }\n}\n","import {\n  cacheExpiryTolerance,\n  defaultAuthEndpoint,\n  tokenProviderTimeout,\n} from \"./constants\";\n\nimport { urlEncode, unixTimeNow } from \"./utils\";\n\nexport default class TokenProvider {\n  constructor({ authEndpoint, authData }) {\n    this.authEndpoint = authEndpoint || defaultAuthEndpoint;\n    this.authData = authData;\n  }\n\n  fetchToken() {\n    if (this.cacheIsStale) {\n      return this.makeAuthRequest().then(responseBody => {\n        this.cache(responseBody.access_token, responseBody.expires_in);\n        return this.cachedToken;\n      });\n    }\n    return Promise.resolve(this.cachedToken);\n  }\n\n  get cacheIsStale() {\n    return !this.cachedToken || unixTimeNow() > this.cacheValidUntil;\n  }\n\n  cache(token, expiresIn) {\n    this.cachedToken = token;\n    this.cacheValidUntil = unixTimeNow() + expiresIn - cacheExpiryTolerance;\n  }\n\n  makeAuthRequest() {\n    return new Promise((resolve, reject) => {\n      const xhr = new XMLHttpRequest();\n      xhr.open(\"POST\", this.authEndpoint);\n      xhr.timeout = tokenProviderTimeout;\n      xhr.onload = () => {\n        if (xhr.status === 200) {\n          resolve(JSON.parse(xhr.responseText));\n        } else {\n          reject(new Error(`Couldn't fetch token from ${\n            this.authEndpoint\n          }; got ${ xhr.status } ${ xhr.statusText }.`));\n        }\n      };\n      xhr.ontimeout = () => {\n        reject(new Error(`Request timed out while fetching token from ${\n          this.authEndpoint\n        }`));\n      }\n      xhr.setRequestHeader(\"content-type\", \"application/x-www-form-urlencoded\");\n      xhr.send(urlEncode({\n        ...this.authData,\n        grant_type: \"client_credentials\",\n      }));\n    });\n  }\n}\n","import PusherPlatform from \"pusher-platform-js\";\nimport Feed from \"./feed\";\nimport TokenProvider from \"./token-provider\";\nimport { servicePath, feedIdRegex, serviceIdRegex } from \"./constants\";\nimport { parseResponse, queryString } from \"./utils\";\n\nexport default class Feeds {\n  constructor({\n    serviceId,\n    cluster,\n    authData = {},\n    authEndpoint,\n    logLevel,\n    logger,\n  } = {}) {\n    this.authData = authData;\n    this.authEndpoint = authEndpoint;\n    if (!serviceId || !serviceId.match(serviceIdRegex)) {\n      throw new TypeError(`Invalid serviceId: ${ serviceId }`);\n    }\n    this.listTokenProvider = new TokenProvider({\n      authEndpoint: this.authEndpoint,\n      authData: {\n        ...this.authData,\n        path: \"feeds\",\n        action: \"READ\",\n      }\n    });\n    this.firehoseTokenProvider = new TokenProvider({\n      authEndpoint: this.authEndpoint,\n      authData: {\n        ...this.authData,\n        path: \"firehose/items\",\n        action: \"READ\",\n      }\n    });\n    if (!logger && logLevel) {\n      logger = new PusherPlatform.ConsoleLogger(logLevel);\n    }\n    this.app = new PusherPlatform.App({ serviceId, cluster, logger });\n  }\n\n  list({ prefix, limit } = {}) {\n    return parseResponse(this.app.request({\n      method: \"GET\",\n      path: `${ servicePath }/feeds` + queryString({ prefix, limit }),\n      tokenProvider: this.listTokenProvider,\n    }));\n  }\n\n  feed(feedId) {\n    if (!feedId || !feedId.match(feedIdRegex)) {\n      throw new TypeError(`Invalid feedId: ${ feedId }`);\n    }\n    const readTokenProvider = feedId.startsWith(\"private-\") ? new TokenProvider({\n      authEndpoint:  this.authEndpoint,\n      authData: {\n        ...this.authData,\n        path: `feeds/${ feedId }/items`,\n        action: \"READ\",\n      }\n    }) : null;\n    return new Feed({\n      app: this.app,\n      feedId,\n      readTokenProvider,\n    });\n  }\n\n  firehose({ onPublish, onSubscribe, onUnsubscribe, ...options } = {}) {\n    validateFirehoseCallbacks({ onPublish, onSubscribe, onUnsubscribe });\n    const onEvent = event => {\n      if (event.body.event_type === 0 && onPublish) {\n        onPublish(event);\n      } else if (event.body.event_type === 1 && onSubscribe) {\n        onSubscribe(event);\n      } else if (event.body.event_type === 2 && onUnsubscribe) {\n        onUnsubscribe(event);\n      }\n    };\n    return this.app.subscribe({\n      ...options,\n      onEvent,\n      path: `${ servicePath }/firehose/items`,\n      tokenProvider: this.firehoseTokenProvider,\n    });\n  }\n}\n\nfunction validateFirehoseCallbacks(callbacks) {\n  const defined = Object.keys(callbacks)\n    .filter(k => callbacks[k] !== undefined)\n    .map(k => ({ name: k, callback: callbacks[k] }));\n  defined.forEach(({ name, callback }) => {\n    if (typeof callback !== \"function\") {\n      throw new TypeError(`${ name } must be a function, got ${ callback }`);\n    }\n  });\n  if (defined.length === 0) {\n    throw new TypeError(`Must provide at least one of onPublish, onSubscribe, or onUnsubscribe`);\n  }\n}\n"],"names":["webpackUniversalModuleDefinition","root","factory","module","this","modules","installedModules","__webpack_require__","moduleId","exports","i","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","getDefault","getModuleExports","object","property","prototype","hasOwnProperty","p","s","__extends","extendStatics","setPrototypeOf","__proto__","Array","b","__","constructor","create","subscription_1","resumable_subscription_1","responseHeadersObj","headerStr","headers","headerPairs","split","length","headerPair","index","indexOf","key","substring","val","ErrorResponse","_super","statusCode","info","_this","JSON","stringify","fromXHR","xhr","status","getAllResponseHeaders","responseText","Error","NetworkError","error","XhrReadyState","BaseClient","options","cluster","replace","baseURL","encrypted","XMLHttpRequest","window","request","createXHR","Promise","resolve","reject","onreadystatechange","readyState","send","body","newSubscription","subOptions","Subscription","path","newResumableSubscription","ResumableSubscription","endpoint","open","method","toUpperCase","setRequestHeader","jwt","LogLevel","ConsoleLogger","threshold","log","logFunction","level","message","loggerSignature","group","groupEnd","verbose","console","VERBOSE","debug","DEBUG","INFO","warn","WARNING","ERROR","EmptyLogger","base_client_1","SubscriptionState","assertState","stateEnum","states","check","some","state","expected","join","actual","assert","trace","UNOPENED","gotEOS","lastNewlineIndex","bind","lastEventId","UNSENT","OPENED","HEADERS_RECEIVED","LOADING","OPENING","OPEN","onOpen","err","onChunk","ENDED","onError","DONE","undefined","onEnd","ENDING","response","newlineIndex","lastIndexOf","rawEvents","slice","_i","rawEvents_1","rawEvent","data","parse","onMessage","isArray","onEventMessage","onEOSMessage","eventMessage","_","id","onEvent","eventId","eosMessage","unsubscribe","abort","retry_strategy_1","ResumableSubscriptionState","xhrSource","lastEventIdReceived","logger","retryStrategy","ExponentialBackoffRetryStrategy","tryNow","newXhr","subscription","reset","event","parseInt","attemptRetry","then","onRetry","catch","tokenProvider","fetchToken","logger_1","Retry","waitTimeMilis","DoNotRetry","limit","retryCount","maxBackoffMilis","defaultBackoffMilis","currentBackoffMilis","initialBackoffMilis","shouldRetry","retryable","isRetryable","backoffMillis","calulateMilisToRetry","setTimeout","__assign","assign","t","arguments","DEFAULT_CLUSTER","App","serviceId","client","sanitizeCluster","absPath","subscribe","resumableSubscribe","resumableSubscription","relativePath","default","app_1","cacheExpiryTolerance","defaultAuthEndpoint","feedIdRegex","serviceIdRegex","servicePath","tokenProviderTimeout","parseResponse","promise","urlEncode","keys","filter","map","encodeURIComponent","queryString","encodedData","unixTimeNow","Math","floor","Date","now","Feed","app","feedId","readTokenProvider","onItem","TypeError","itemsPath","tailSize","fromId","TokenProvider","authEndpoint","authData","cacheIsStale","makeAuthRequest","cache","responseBody","access_token","expires_in","cachedToken","token","expiresIn","cacheValidUntil","timeout","onload","statusText","ontimeout","Feeds","logLevel","match","listTokenProvider","firehoseTokenProvider","PusherPlatform","prefix","startsWith","onPublish","onSubscribe","onUnsubscribe","event_type","validateFirehoseCallbacks","callbacks","defined","k","callback","forEach"],"mappings":"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"}