{"version":3,"file":"pusher-feeds-client.js","sources":["../node_modules/pusher-platform/target/pusher-platform.js","../src/utils.js","../src/feed.js","../src/constants.js","../src/token-provider.js","../src/feeds.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"PusherPlatform\"] = factory();\n\telse\n\t\troot[\"PusherPlatform\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 8);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar logger_1 = __webpack_require__(1);\nvar resumable_subscription_1 = __webpack_require__(3);\nvar retry_strategy_1 = __webpack_require__(4);\nvar stateless_subscription_1 = __webpack_require__(5);\nfunction responseHeadersObj(headerStr) {\n    var headers = {};\n    if (!headerStr) {\n        return headers;\n    }\n    var headerPairs = headerStr.split('\\u000d\\u000a');\n    for (var i = 0; i < headerPairs.length; i++) {\n        var headerPair = headerPairs[i];\n        var index = headerPair.indexOf('\\u003a\\u0020');\n        if (index > 0) {\n            var key = headerPair.substring(0, index);\n            var val = headerPair.substring(index + 2);\n            headers[key] = val;\n        }\n    }\n    return headers;\n}\nexports.responseHeadersObj = responseHeadersObj;\nvar ErrorResponse = (function (_super) {\n    __extends(ErrorResponse, _super);\n    function ErrorResponse(statusCode, headers, info) {\n        var _this = _super.call(this, \"ErroResponse: \" + statusCode + \": \" + info + \" \\n Headers: \" + JSON.stringify(headers)) || this;\n        Object.setPrototypeOf(_this, ErrorResponse.prototype);\n        _this.statusCode = statusCode;\n        _this.headers = headers;\n        _this.info = info;\n        return _this;\n    }\n    ErrorResponse.fromXHR = function (xhr) {\n        return new ErrorResponse(xhr.status, responseHeadersObj(xhr.getAllResponseHeaders()), xhr.responseText);\n    };\n    return ErrorResponse;\n}(Error));\nexports.ErrorResponse = ErrorResponse;\nvar NetworkError = (function (_super) {\n    __extends(NetworkError, _super);\n    function NetworkError(error) {\n        var _this = _super.call(this, error) || this;\n        //TODO: ugly hack to make the instanceof calls work. We might have to find a better solution.\n        Object.setPrototypeOf(_this, NetworkError.prototype);\n        _this.error = error;\n        return _this;\n    }\n    return NetworkError;\n}(Error));\nexports.NetworkError = NetworkError;\n// Follows https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/readyState\nvar XhrReadyState;\n(function (XhrReadyState) {\n    XhrReadyState[XhrReadyState[\"UNSENT\"] = 0] = \"UNSENT\";\n    XhrReadyState[XhrReadyState[\"OPENED\"] = 1] = \"OPENED\";\n    XhrReadyState[XhrReadyState[\"HEADERS_RECEIVED\"] = 2] = \"HEADERS_RECEIVED\";\n    XhrReadyState[XhrReadyState[\"LOADING\"] = 3] = \"LOADING\";\n    XhrReadyState[XhrReadyState[\"DONE\"] = 4] = \"DONE\";\n})(XhrReadyState = exports.XhrReadyState || (exports.XhrReadyState = {}));\nvar BaseClient = (function () {\n    function BaseClient(options) {\n        this.options = options;\n        var host = options.host.replace(/\\/$/, '');\n        this.baseURL = (options.encrypted !== false ? \"https\" : \"http\") + \"://\" + host;\n        this.XMLHttpRequest = options.XMLHttpRequest || window.XMLHttpRequest;\n        this.logger = options.logger || new logger_1.ConsoleLogger();\n    }\n    BaseClient.prototype.request = function (options) {\n        var xhr = this.createXHR(this.baseURL, options);\n        //TODO: add retrying\n        return new Promise(function (resolve, reject) {\n            xhr.onreadystatechange = function () {\n                if (xhr.readyState === 4) {\n                    if (xhr.status === 200) {\n                        resolve(xhr.responseText);\n                    }\n                    else {\n                        reject(ErrorResponse.fromXHR(xhr));\n                    }\n                }\n            };\n            xhr.send(JSON.stringify(options.body));\n        });\n    };\n    BaseClient.prototype.newStatelessSubscription = function (subOptions) {\n        var _this = this;\n        var method = \"SUBSCRIBE\";\n        if (!subOptions.retryStrategy) {\n            subOptions.retryStrategy = new retry_strategy_1.ExponentialBackoffRetryStrategy({\n                logger: this.logger,\n                requestMethod: method\n            });\n        }\n        return new stateless_subscription_1.StatelessSubscription(function () {\n            return _this.createXHR(_this.baseURL, {\n                method: method,\n                path: subOptions.path,\n                headers: {},\n                body: null,\n            });\n        }, subOptions);\n    };\n    BaseClient.prototype.newResumableSubscription = function (subOptions) {\n        var _this = this;\n        var method = \"SUBSCRIBE\";\n        if (!subOptions.retryStrategy) {\n            subOptions.retryStrategy = new retry_strategy_1.ExponentialBackoffRetryStrategy({\n                logger: this.logger,\n                requestMethod: method\n            });\n        }\n        return new resumable_subscription_1.ResumableSubscription(function () {\n            return _this.createXHR(_this.baseURL, {\n                method: method,\n                path: subOptions.path,\n                headers: {},\n                body: null,\n            });\n        }, subOptions);\n    };\n    BaseClient.prototype.createXHR = function (baseURL, options) {\n        var XMLHttpRequest = this.XMLHttpRequest;\n        var xhr = new XMLHttpRequest();\n        var path = options.path.replace(/^\\/+/, \"\");\n        var endpoint = baseURL + \"/\" + path;\n        xhr.open(options.method.toUpperCase(), endpoint, true);\n        if (options.body) {\n            xhr.setRequestHeader(\"content-type\", \"application/json\");\n        }\n        if (options.jwt) {\n            xhr.setRequestHeader(\"authorization\", \"Bearer \" + options.jwt);\n        }\n        for (var key in options.headers) {\n            xhr.setRequestHeader(key, options.headers[key]);\n        }\n        return xhr;\n    };\n    return BaseClient;\n}());\nexports.BaseClient = BaseClient;\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar LogLevel;\n(function (LogLevel) {\n    LogLevel[LogLevel[\"VERBOSE\"] = 1] = \"VERBOSE\";\n    LogLevel[LogLevel[\"DEBUG\"] = 2] = \"DEBUG\";\n    LogLevel[LogLevel[\"INFO\"] = 3] = \"INFO\";\n    LogLevel[LogLevel[\"WARNING\"] = 4] = \"WARNING\";\n    LogLevel[LogLevel[\"ERROR\"] = 5] = \"ERROR\";\n})(LogLevel = exports.LogLevel || (exports.LogLevel = {}));\n/**\n * Default implementation of the Logger. Wraps standards console calls.\n * Logs only calls that are at or above the threshold (verbose/debug/info/warn/error)\n * If error is passed, it will append the message to the error object.\n */\nvar ConsoleLogger = (function () {\n    function ConsoleLogger(threshold) {\n        if (threshold === void 0) { threshold = 2; }\n        this.threshold = threshold;\n    }\n    ConsoleLogger.prototype.log = function (logFunction, level, message, error) {\n        if (level >= this.threshold) {\n            var loggerSignature = \"Logger.\" + LogLevel[level];\n            if (error) {\n                console.group();\n                logFunction(loggerSignature + \": \" + message);\n                logFunction(error);\n                console.groupEnd();\n            }\n            else {\n                logFunction(loggerSignature + \": \" + message);\n            }\n        }\n    };\n    ConsoleLogger.prototype.verbose = function (message, error) {\n        this.log(console.log, LogLevel.VERBOSE, message, error);\n    };\n    ConsoleLogger.prototype.debug = function (message, error) {\n        this.log(console.log, LogLevel.DEBUG, message, error);\n    };\n    ConsoleLogger.prototype.info = function (message, error) {\n        this.log(console.info, LogLevel.INFO, message, error);\n    };\n    ConsoleLogger.prototype.warn = function (message, error) {\n        this.log(console.warn, LogLevel.WARNING, message, error);\n    };\n    ConsoleLogger.prototype.error = function (message, error) {\n        this.log(console.error, LogLevel.ERROR, message, error);\n    };\n    return ConsoleLogger;\n}());\nexports.ConsoleLogger = ConsoleLogger;\nvar EmptyLogger = (function () {\n    function EmptyLogger() {\n    }\n    EmptyLogger.prototype.verbose = function (message, error) { };\n    ;\n    EmptyLogger.prototype.debug = function (message, error) { };\n    ;\n    EmptyLogger.prototype.info = function (message, error) { };\n    ;\n    EmptyLogger.prototype.warn = function (message, error) { };\n    ;\n    EmptyLogger.prototype.error = function (message, error) { };\n    ;\n    return EmptyLogger;\n}());\nexports.EmptyLogger = EmptyLogger;\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Wrapper around the token provider that contains a retry strategy\n * TODO: test\n * Currently not used anywhere\n */\nvar RetryingTokenProvider = (function () {\n    function RetryingTokenProvider(baseTokenProvider, retryStrategy) {\n        this.baseTokenProvider = baseTokenProvider;\n        this.retryStrategy = retryStrategy;\n    }\n    RetryingTokenProvider.prototype.fetchToken = function () {\n        return this.tryFetching();\n    };\n    RetryingTokenProvider.prototype.invalidateToken = function (token) {\n        this.baseTokenProvider.invalidateToken(token);\n    };\n    RetryingTokenProvider.prototype.tryFetching = function () {\n        var _this = this;\n        return new Promise(function (resolve, reject) {\n            _this.baseTokenProvider.fetchToken()\n                .then(function (token) {\n                resolve(token);\n            }).catch(function (error) {\n                _this.retryStrategy.checkIfRetryable(error)\n                    .then(function () {\n                    _this.tryFetching();\n                }).catch(function (error) {\n                    reject(error);\n                });\n            });\n        });\n    };\n    return RetryingTokenProvider;\n}());\nexports.RetryingTokenProvider = RetryingTokenProvider;\n/**\n * No-op token provider. Fetches undefined so we can more easily replace it.\n * Never fails.\n */\nvar NoOpTokenProvider = (function () {\n    function NoOpTokenProvider() {\n    }\n    NoOpTokenProvider.prototype.fetchToken = function () {\n        return new Promise(function (resolve) {\n            resolve(undefined);\n        });\n    };\n    NoOpTokenProvider.prototype.invalidateToken = function (token) { };\n    return NoOpTokenProvider;\n}());\nexports.NoOpTokenProvider = NoOpTokenProvider;\n/**\n * A token provider that always returns the same token. Can be used for debugging purposes.\n */\nvar FixedTokenProvider = (function () {\n    function FixedTokenProvider(jwt) {\n        this.jwt = jwt;\n    }\n    FixedTokenProvider.prototype.fetchToken = function () {\n        var _this = this;\n        return new Promise(function (resolve) {\n            resolve(_this.jwt);\n        });\n    };\n    FixedTokenProvider.prototype.invalidateToken = function (token) { };\n    return FixedTokenProvider;\n}());\nexports.FixedTokenProvider = FixedTokenProvider;\n\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar token_provider_1 = __webpack_require__(2);\nvar base_subscription_1 = __webpack_require__(6);\nvar ResumableSubscription = (function () {\n    function ResumableSubscription(xhrSource, options) {\n        this.xhrSource = xhrSource;\n        this.options = options;\n        this.lastEventIdReceived = options.lastEventId;\n        this.logger = options.logger;\n        this.retryStrategy = options.retryStrategy;\n        if (!this.options.tokenProvider)\n            this.options.tokenProvider = new token_provider_1.NoOpTokenProvider();\n        this.options = base_subscription_1.replaceUnimplementedListenersWithNoOps(options);\n    }\n    ResumableSubscription.prototype.tryNow = function () {\n        var _this = this;\n        var newXhr = this.xhrSource();\n        if (this.lastEventIdReceived) {\n            newXhr.setRequestHeader(\"Last-Event-Id\", this.lastEventIdReceived);\n        }\n        this.options.tokenProvider.fetchToken()\n            .then(function (token) {\n            _this.baseSubscription = new base_subscription_1.BaseSubscription(newXhr, {\n                path: _this.options.path,\n                headers: _this.options.headers,\n                jwt: token,\n                onOpen: function () {\n                    _this.options.onOpen();\n                    _this.retryStrategy.reset(); //We need to reset the counter once the connection has been re-established.\n                },\n                onEvent: function (event) {\n                    _this.options.onEvent(event);\n                    _this.lastEventIdReceived = event.eventId;\n                },\n                onEnd: _this.options.onEnd,\n                onError: function (error) {\n                    _this.retryStrategy.checkIfRetryable(error)\n                        .then(function () {\n                        if (_this.options.onRetry) {\n                            _this.options.onRetry();\n                        }\n                        else {\n                            _this.tryNow();\n                        }\n                    })\n                        .catch(function (error) {\n                        _this.options.onError(error);\n                    });\n                },\n                logger: _this.logger\n            });\n            _this.baseSubscription.open();\n        })\n            .catch(function (error) {\n            _this.options.onError(error);\n        });\n    };\n    ResumableSubscription.prototype.open = function () {\n        this.tryNow();\n    };\n    ResumableSubscription.prototype.unsubscribe = function () {\n        if (!this.baseSubscription) {\n            throw new Error(\"Subscription doesn't exist! Have you called open()?\");\n        }\n        this.retryStrategy.cancel();\n        this.baseSubscription.unsubscribe(); // We'll get onEnd and bubble this up\n    };\n    return ResumableSubscription;\n}());\nexports.ResumableSubscription = ResumableSubscription;\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar base_client_1 = __webpack_require__(0);\nvar Retry = (function () {\n    function Retry(waitTimeMillis) {\n        this.waitTimeMillis = waitTimeMillis;\n    }\n    return Retry;\n}());\nexports.Retry = Retry;\nvar DoNotRetry = (function () {\n    function DoNotRetry(error) {\n        this.error = error;\n    }\n    return DoNotRetry;\n}());\nexports.DoNotRetry = DoNotRetry;\nvar ExponentialBackoffRetryStrategy = (function () {\n    function ExponentialBackoffRetryStrategy(options) {\n        this.retryUnsafeRequests = false;\n        this.limit = -1;\n        this.retryCount = 0;\n        this.maxBackoffMillis = 5000;\n        this.defaultBackoffMillis = 1000;\n        this.currentBackoffMillis = this.defaultBackoffMillis;\n        this.pendingTimeouts = new Set();\n        this.requestMethod = options.requestMethod;\n        this.logger = options.logger;\n        if (options.retryUnsafeRequests)\n            this.retryUnsafeRequests = options.retryUnsafeRequests;\n        //Backoff limits\n        if (options.limit)\n            this.limit = options.limit;\n        if (options.initialBackoffMillis) {\n            this.currentBackoffMillis = options.initialBackoffMillis;\n            this.defaultBackoffMillis = options.initialBackoffMillis;\n        }\n        if (options.maxBackoffMillis)\n            this.maxBackoffMillis = options.maxBackoffMillis;\n    }\n    ExponentialBackoffRetryStrategy.prototype.checkIfRetryable = function (error) {\n        var _this = this;\n        return new Promise(function (resolve, reject) {\n            var shouldRetry = _this.shouldRetry(error);\n            if (shouldRetry instanceof DoNotRetry) {\n                reject(error);\n            }\n            else if (shouldRetry instanceof Retry) {\n                _this.retryCount += 1;\n                var timeout_1 = window.setTimeout(function () {\n                    _this.pendingTimeouts.delete(timeout_1);\n                    resolve();\n                }, shouldRetry.waitTimeMillis);\n                _this.pendingTimeouts.add(timeout_1);\n            }\n        });\n    };\n    ExponentialBackoffRetryStrategy.prototype.reset = function () {\n        this.retryCount = 0;\n        this.currentBackoffMillis = this.defaultBackoffMillis;\n    };\n    ExponentialBackoffRetryStrategy.prototype.cancel = function () {\n        var _this = this;\n        this.pendingTimeouts.forEach(function (timeout) {\n            window.clearTimeout(timeout);\n            _this.pendingTimeouts.delete(timeout);\n        });\n    };\n    ExponentialBackoffRetryStrategy.prototype.requestMethodIsSafe = function () {\n        switch (this.requestMethod) {\n            case 'GET':\n            case 'HEAD':\n            case 'OPTIONS':\n            case 'SUBSCRIBE':\n                return true;\n            default:\n                return false;\n        }\n    };\n    ExponentialBackoffRetryStrategy.prototype.shouldRetry = function (error) {\n        this.logger.verbose(this.constructor.name + \":  Error received\", error);\n        if (this.retryCount >= this.limit && this.limit >= 0) {\n            this.logger.verbose(this.constructor.name + \":  Retry count is over the maximum limit: \" + this.limit);\n            return new DoNotRetry(error);\n        }\n        if (error instanceof base_client_1.ErrorResponse && error.headers['Retry-After']) {\n            this.logger.verbose(this.constructor.name + \":  Retry-After header is present, retrying in \" + error.headers['Retry-After']);\n            return new Retry(parseInt(error.headers['Retry-After']) * 1000);\n        }\n        if (error instanceof base_client_1.NetworkError || this.requestMethodIsSafe() || this.retryUnsafeRequests) {\n            return this.shouldSafeRetry(error);\n        }\n        this.logger.verbose(this.constructor.name + \": Error is not retryable\", error);\n        return new DoNotRetry(error);\n    };\n    ExponentialBackoffRetryStrategy.prototype.shouldSafeRetry = function (error) {\n        if (error instanceof base_client_1.NetworkError) {\n            this.logger.verbose(this.constructor.name + \": It's a Network Error, will retry\", error);\n            return new Retry(this.calulateMillisToRetry());\n        }\n        if (error instanceof base_client_1.ErrorResponse) {\n            if (error.statusCode >= 500 && error.statusCode < 600) {\n                this.logger.verbose(this.constructor.name + \": Error 5xx, will retry\");\n                return new Retry(this.calulateMillisToRetry());\n            }\n            if (error.statusCode === 401) {\n                this.logger.verbose(this.constructor.name + \": Error 401 - probably expired token, retrying immediately\");\n                return new Retry(0); //Token expired - can retry immediately\n            }\n        }\n        this.logger.verbose(this.constructor.name + \": Error is not retryable\", error);\n        return new DoNotRetry(error);\n    };\n    ExponentialBackoffRetryStrategy.prototype.calulateMillisToRetry = function () {\n        if (this.currentBackoffMillis >= this.maxBackoffMillis || this.currentBackoffMillis * 2 >= this.maxBackoffMillis) {\n            this.currentBackoffMillis = this.maxBackoffMillis;\n        }\n        else if (this.retryCount > 0) {\n            this.currentBackoffMillis = this.currentBackoffMillis * 2;\n        }\n        this.logger.verbose(\"Retrying in \" + this.currentBackoffMillis + \"ms\");\n        return this.currentBackoffMillis;\n    };\n    return ExponentialBackoffRetryStrategy;\n}());\nexports.ExponentialBackoffRetryStrategy = ExponentialBackoffRetryStrategy;\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar token_provider_1 = __webpack_require__(2);\nvar base_subscription_1 = __webpack_require__(6);\n// pattern of callbacks: ((onOpening (onOpen onEvent*)?)? (onError|onEnd)) | onError\nvar StatelessSubscription = (function () {\n    function StatelessSubscription(xhrSource, options) {\n        this.xhrSource = xhrSource;\n        this.options = options;\n        this.logger = options.logger;\n        if (!this.options.tokenProvider)\n            this.options.tokenProvider = new token_provider_1.NoOpTokenProvider();\n        this.options = base_subscription_1.replaceUnimplementedListenersWithNoOps(options);\n        this.retryStrategy = options.retryStrategy;\n    }\n    StatelessSubscription.prototype.tryNow = function () {\n        var _this = this;\n        var newXhr = this.xhrSource();\n        this.options.tokenProvider.fetchToken()\n            .then(function (token) {\n            _this.baseSubscription = new base_subscription_1.BaseSubscription(newXhr, {\n                path: _this.options.path,\n                headers: _this.options.headers,\n                jwt: token,\n                onOpen: function () {\n                    _this.options.onOpen();\n                    _this.retryStrategy.reset(); //We need to reset the counter once the connection has been re-established.\n                },\n                onEvent: _this.options.onEvent,\n                onEnd: _this.options.onEnd,\n                onError: function (error) {\n                    _this.retryStrategy.checkIfRetryable(error)\n                        .then(function () {\n                        _this.logger.verbose(\"Then!\");\n                        if (_this.options.onRetry) {\n                            _this.options.onRetry();\n                        }\n                        else {\n                            _this.tryNow();\n                        }\n                    })\n                        .catch(function (error) {\n                        _this.options.onError(error);\n                    });\n                },\n                logger: _this.logger\n            });\n            _this.baseSubscription.open();\n        })\n            .catch(function (error) {\n            _this.options.onError(error);\n        });\n    };\n    StatelessSubscription.prototype.open = function () {\n        this.tryNow();\n    };\n    StatelessSubscription.prototype.unsubscribe = function () {\n        if (!this.baseSubscription) {\n            throw new Error(\"Subscription doesn't exist! Have you called open()?\");\n        }\n        this.retryStrategy.cancel();\n        this.baseSubscription.unsubscribe(); // We'll get onEnd and bubble this up\n    };\n    return StatelessSubscription;\n}());\nexports.StatelessSubscription = StatelessSubscription;\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar base_client_1 = __webpack_require__(0);\nvar SubscriptionState;\n(function (SubscriptionState) {\n    SubscriptionState[SubscriptionState[\"UNOPENED\"] = 0] = \"UNOPENED\";\n    SubscriptionState[SubscriptionState[\"OPENING\"] = 1] = \"OPENING\";\n    SubscriptionState[SubscriptionState[\"OPEN\"] = 2] = \"OPEN\";\n    SubscriptionState[SubscriptionState[\"ENDING\"] = 3] = \"ENDING\";\n    SubscriptionState[SubscriptionState[\"ENDED\"] = 4] = \"ENDED\"; // called onEnd() or onError(err)\n})(SubscriptionState = exports.SubscriptionState || (exports.SubscriptionState = {}));\n/**\n* Allows avoiding making null check every. Single. Time.\n* @param options the options that come in\n* @returns the mutated options\n* TODO: should this be cloned instead?\n*/\nfunction replaceUnimplementedListenersWithNoOps(options) {\n    if (!options.onOpen)\n        options.onOpen = function () { };\n    if (!options.onEvent)\n        options.onEvent = function (event) { };\n    if (!options.onEnd)\n        options.onEnd = function () { };\n    if (!options.onError)\n        options.onError = function (error) { };\n    return options;\n}\nexports.replaceUnimplementedListenersWithNoOps = replaceUnimplementedListenersWithNoOps;\nvar BaseSubscription = (function () {\n    function BaseSubscription(xhr, options) {\n        var _this = this;\n        this.xhr = xhr;\n        this.options = options;\n        this.state = SubscriptionState.UNOPENED;\n        this.lastNewlineIndex = 0;\n        /******\n        Message parsing\n        ******/\n        this.gotEOS = false;\n        //Apply headers    \n        for (var key in options.headers) {\n            xhr.setRequestHeader(key, options.headers[key]);\n        }\n        xhr.onreadystatechange = function () {\n            switch (_this.xhr.readyState) {\n                case base_client_1.XhrReadyState.UNSENT:\n                case base_client_1.XhrReadyState.OPENED:\n                case base_client_1.XhrReadyState.HEADERS_RECEIVED:\n                    _this.assertStateIsIn(SubscriptionState.OPENING);\n                    break;\n                case base_client_1.XhrReadyState.LOADING:\n                    _this.onLoading();\n                    break;\n                case base_client_1.XhrReadyState.DONE:\n                    _this.onDone();\n                    break;\n            }\n        };\n    }\n    BaseSubscription.prototype.open = function () {\n        if (this.state !== SubscriptionState.UNOPENED) {\n            throw new Error(\"Called .open() on Subscription object in unexpected state: \" + this.state);\n        }\n        this.state = SubscriptionState.OPENING;\n        if (this.options.jwt) {\n            this.xhr.setRequestHeader(\"authorization\", \"Bearer \" + this.options.jwt);\n        }\n        this.xhr.send();\n    };\n    BaseSubscription.prototype.unsubscribe = function () {\n        this.state = SubscriptionState.ENDED;\n        this.xhr.abort();\n        this.options.onEnd();\n    };\n    BaseSubscription.prototype.onLoading = function () {\n        this.assertStateIsIn(SubscriptionState.OPENING, SubscriptionState.OPEN, SubscriptionState.ENDING);\n        if (this.xhr.status === 200) {\n            //Check if we just transitioned to the open state\n            if (this.state === SubscriptionState.OPENING) {\n                this.state = SubscriptionState.OPEN;\n                this.options.onOpen();\n            }\n            this.assertStateIsIn(SubscriptionState.OPEN);\n            var err = this.onChunk(); // might transition our state from OPEN -> ENDING\n            this.assertStateIsIn(SubscriptionState.OPEN, SubscriptionState.ENDING);\n            if (err) {\n                this.state = SubscriptionState.ENDED;\n                if (err.statusCode != 204) {\n                    this.options.onError(err);\n                }\n                // Because we abort()ed, we will get no more calls to our onreadystatechange handler,\n                // and so we will not call the event handler again.\n                // Finish with options.onError instead of the options.onEnd.\n            }\n            else {\n                // We consumed some response text, and all's fine. We expect more text.\n            }\n        }\n    };\n    BaseSubscription.prototype.onDone = function () {\n        if (this.xhr.status === 200) {\n            if (this.state === SubscriptionState.OPENING) {\n                this.state = SubscriptionState.OPEN;\n                this.options.onOpen();\n            }\n            this.assertStateIsIn(SubscriptionState.OPEN, SubscriptionState.ENDING);\n            var err = this.onChunk();\n            if (err) {\n                this.state = SubscriptionState.ENDED;\n                if (err.statusCode === 204) {\n                    this.options.onEnd();\n                }\n                else {\n                    this.options.onError(err);\n                }\n            }\n            else if (this.state <= SubscriptionState.ENDING) {\n                this.options.onError(new Error(\"HTTP response ended without receiving EOS message\"));\n            }\n            else {\n                // Stream ended normally.\n                this.options.onEnd();\n            }\n        }\n        else {\n            this.assertStateIsIn(SubscriptionState.OPENING, SubscriptionState.OPEN, SubscriptionState.ENDED);\n            if (this.state === SubscriptionState.ENDED) {\n                // We aborted the request deliberately, and called onError/onEnd elsewhere.\n                return;\n            }\n            else if (this.xhr.status === 0) {\n                this.options.onError(new base_client_1.NetworkError(\"Connection lost.\"));\n            }\n            else {\n                this.options.onError(base_client_1.ErrorResponse.fromXHR(this.xhr));\n            }\n        }\n    };\n    BaseSubscription.prototype.onChunk = function () {\n        this.assertStateIsIn(SubscriptionState.OPEN);\n        var response = this.xhr.responseText;\n        var newlineIndex = response.lastIndexOf(\"\\n\");\n        if (newlineIndex > this.lastNewlineIndex) {\n            var rawEvents = response.slice(this.lastNewlineIndex, newlineIndex).split(\"\\n\");\n            this.lastNewlineIndex = newlineIndex;\n            for (var _i = 0, rawEvents_1 = rawEvents; _i < rawEvents_1.length; _i++) {\n                var rawEvent = rawEvents_1[_i];\n                if (rawEvent.length === 0) {\n                    continue; // FIXME why? This should be a protocol error\n                }\n                var data = JSON.parse(rawEvent);\n                var err = this.onMessage(data);\n                if (err != null) {\n                    return err;\n                }\n            }\n        }\n    };\n    /**\n    * Calls options.onEvent 0+ times, then returns an Error or null\n    * Also asserts the message is formatted correctly and we're in an allowed state (not terminated).\n    */\n    BaseSubscription.prototype.onMessage = function (message) {\n        this.assertStateIsIn(SubscriptionState.OPEN);\n        this.verifyMessage(message);\n        switch (message[0]) {\n            case 0:\n                return null;\n            case 1:\n                return this.onEventMessage(message);\n            case 255:\n                return this.onEOSMessage(message);\n            default:\n                return new Error(\"Unknown Message: \" + JSON.stringify(message));\n        }\n    };\n    // EITHER calls options.onEvent, OR returns an error\n    BaseSubscription.prototype.onEventMessage = function (eventMessage) {\n        this.assertStateIsIn(SubscriptionState.OPEN);\n        if (eventMessage.length !== 4) {\n            return new Error(\"Event message has \" + eventMessage.length + \" elements (expected 4)\");\n        }\n        var _ = eventMessage[0], id = eventMessage[1], headers = eventMessage[2], body = eventMessage[3];\n        if (typeof id !== \"string\") {\n            return new Error(\"Invalid event ID in message: \" + JSON.stringify(eventMessage));\n        }\n        if (typeof headers !== \"object\" || Array.isArray(headers)) {\n            return new Error(\"Invalid event headers in message: \" + JSON.stringify(eventMessage));\n        }\n        this.options.onEvent({ eventId: id, headers: headers, body: body });\n    };\n    /**\n    * EOS message received. Sets subscription state to Ending and returns an error with given status code\n    * @param eosMessage final message of the subscription\n    */\n    BaseSubscription.prototype.onEOSMessage = function (eosMessage) {\n        this.assertStateIsIn(SubscriptionState.OPEN);\n        if (eosMessage.length !== 4) {\n            return new Error(\"EOS message has \" + eosMessage.length + \" elements (expected 4)\");\n        }\n        var _ = eosMessage[0], statusCode = eosMessage[1], headers = eosMessage[2], info = eosMessage[3];\n        if (typeof statusCode !== \"number\") {\n            return new Error(\"Invalid EOS Status Code\");\n        }\n        if (typeof headers !== \"object\" || Array.isArray(headers)) {\n            return new Error(\"Invalid EOS Headers\");\n        }\n        this.state = SubscriptionState.ENDING;\n        return new base_client_1.ErrorResponse(statusCode, headers, info);\n    };\n    /******\n    Utility methods\n    ******/\n    /**\n    * Asserts whether this subscription falls in one of the expected states and logs a warning if it's not.\n    * @param validStates Array of possible states this subscription could be in.\n    */\n    BaseSubscription.prototype.assertStateIsIn = function () {\n        var _this = this;\n        var validStates = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            validStates[_i] = arguments[_i];\n        }\n        var stateIsValid = validStates.some(function (validState) { return validState === _this.state; });\n        if (!stateIsValid) {\n            var expectedStates = validStates.map(function (state) { return SubscriptionState[state]; }).join(', ');\n            var actualState = SubscriptionState[this.state];\n            this.options.logger.warn(\"Expected this.state to be one of [\" + expectedStates + \"] but it is \" + actualState);\n        }\n    };\n    /**\n    * Check if a single subscription message is in the right format.\n    * @param message The message to check.\n    * @returns null or error if the message is wrong.\n    */\n    BaseSubscription.prototype.verifyMessage = function (message) {\n        if (this.gotEOS) {\n            return new Error(\"Got another message after EOS message\");\n        }\n        if (!Array.isArray(message)) {\n            return new Error(\"Message is not an array\");\n        }\n        if (message.length < 1) {\n            return new Error(\"Message is empty array\");\n        }\n    };\n    return BaseSubscription;\n}());\nexports.BaseSubscription = BaseSubscription;\n\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar base_client_1 = __webpack_require__(0);\nvar logger_1 = __webpack_require__(1);\nvar HOST_BASE = \"pusherplatform.io\";\nvar Instance = (function () {\n    function Instance(options) {\n        if (!options.instanceId)\n            throw new Error('Expected `instanceId` property in Instance options!');\n        if (options.instanceId.split(\":\").length !== 3)\n            throw new Error('The instance property is in the wrong format!');\n        if (!options.serviceName)\n            throw new Error('Expected `serviceName` property in Instance options!');\n        if (!options.serviceVersion)\n            throw new Error('Expected `serviceVersion` property in Instance otpions!');\n        var splitInstance = options.instanceId.split(\":\");\n        this.platformVersion = splitInstance[0];\n        this.cluster = splitInstance[1];\n        this.id = splitInstance[2];\n        this.serviceName = options.serviceName;\n        this.serviceVersion = options.serviceVersion;\n        this.host = options.host || this.cluster + \".\" + HOST_BASE;\n        this.logger = options.logger || new logger_1.ConsoleLogger();\n        this.client = options.client || new base_client_1.BaseClient({\n            encrypted: options.encrypted,\n            host: this.host,\n            logger: this.logger\n        });\n    }\n    Instance.prototype.request = function (options) {\n        var _this = this;\n        options.path = this.absPath(options.path);\n        if (!options.logger)\n            options.logger = this.logger;\n        if (!options.jwt && options.tokenProvider) {\n            return options.tokenProvider.fetchToken().then(function (jwt) {\n                return _this.client.request(__assign({ jwt: jwt }, options));\n            });\n        }\n        else {\n            return this.client.request(options);\n        }\n    };\n    Instance.prototype.subscribe = function (options) {\n        this.logger.verbose(\"Starting to statelessly subscribe\");\n        options.path = this.absPath(options.path);\n        if (!options.logger)\n            options.logger = this.logger;\n        var subscription = this.client.newStatelessSubscription(__assign({}, options));\n        subscription.open();\n        return subscription;\n    };\n    Instance.prototype.resumableSubscribe = function (options) {\n        options.path = this.absPath(options.path);\n        if (!options.logger)\n            options.logger = this.logger;\n        var resumableSubscription = this.client.newResumableSubscription(__assign({}, options));\n        resumableSubscription.open();\n        return resumableSubscription;\n    };\n    Instance.prototype.absPath = function (relativePath) {\n        return (\"/services/\" + this.serviceName + \"/\" + this.serviceVersion + \"/\" + this.id + \"/\" + relativePath).replace(/\\/+/g, \"/\").replace(/\\/+$/, \"\");\n    };\n    return Instance;\n}());\nexports.default = Instance;\n\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar token_provider_1 = __webpack_require__(2);\nexports.FixedTokenProvider = token_provider_1.FixedTokenProvider;\nexports.RetryingTokenProvider = token_provider_1.RetryingTokenProvider;\nexports.NoOpTokenProvider = token_provider_1.NoOpTokenProvider;\nvar instance_1 = __webpack_require__(7);\nexports.Instance = instance_1.default;\nvar base_client_1 = __webpack_require__(0);\nexports.BaseClient = base_client_1.BaseClient;\nvar logger_1 = __webpack_require__(1);\nexports.ConsoleLogger = logger_1.ConsoleLogger;\nexports.EmptyLogger = logger_1.EmptyLogger;\nvar resumable_subscription_1 = __webpack_require__(3);\nexports.ResumableSubscription = resumable_subscription_1.ResumableSubscription;\nvar stateless_subscription_1 = __webpack_require__(5);\nexports.StatelessSubscription = stateless_subscription_1.StatelessSubscription;\nvar retry_strategy_1 = __webpack_require__(4);\nexports.ExponentialBackoffRetryStrategy = retry_strategy_1.ExponentialBackoffRetryStrategy;\nexports.default = {\n    Instance: instance_1.default,\n    BaseClient: base_client_1.BaseClient,\n    ResumableSubscription: resumable_subscription_1.ResumableSubscription,\n    StatelessSubscription: stateless_subscription_1.StatelessSubscription,\n    ExponentialBackoffRetryStrategy: retry_strategy_1.ExponentialBackoffRetryStrategy,\n    ConsoleLogger: logger_1.ConsoleLogger, EmptyLogger: logger_1.EmptyLogger,\n    NoOpTokenProvider: token_provider_1.NoOpTokenProvider, RetryingTokenProvider: token_provider_1.RetryingTokenProvider, FixedTokenProvider: token_provider_1.FixedTokenProvider\n};\n\n\n/***/ })\n/******/ ]);\n});","export function parseResponse(promise) {\n  return new Promise((resolve, reject) => {\n    promise.then(response => {\n      try {\n        resolve(JSON.parse(response));\n      } catch (err) {\n        reject(err);\n      }\n    }).catch(reject);\n  });\n}\n\nexport function urlEncode(data) {\n  return Object.keys(data)\n    .filter(key => data[key] !== undefined)\n    .map(key => `${ key }=${ encodeURIComponent(data[key]) }`)\n    .join(\"&\");\n}\n\nexport function queryString(data) {\n  const encodedData = urlEncode(data);\n  return encodedData ? `?${ encodedData }` : \"\";\n}\n\nexport function unixTimeNow() {\n  return Math.floor(Date.now() / 1000);\n}\n","import { parseResponse, queryString } from \"./utils\";\n\nexport default class Feed {\n  constructor({ instance, feedId, readTokenProvider }) {\n    this.instance = instance;\n    this.feedId = feedId;\n    this.readTokenProvider = readTokenProvider;\n  }\n\n  subscribe(options = {}) {\n    if (typeof options.onItem !== \"function\") {\n      throw new TypeError(\"Must provide an `onItem` callback\");\n    }\n    return this.instance.resumableSubscribe({\n      ...options,\n      // Mapping our itemId to platform library eventId\n      lastEventId: options.lastItemId,\n      path: `feeds/${ this.feedId }/items` + queryString({\n        previous_items: options.previousItems,\n      }),\n      tokenProvider: this.readTokenProvider,\n      onEvent: ({body, eventId}) => options.onItem({ id: eventId, ...body })\n    });\n  }\n\n  paginate({ cursor, limit = 50 } = {}) {\n    return parseResponse(this.instance.request({\n      method: \"GET\",\n      path: `feeds/${ this.feedId }/items` + queryString({\n        cursor,\n        limit,\n      }),\n      tokenProvider: this.readTokenProvider,\n    }));\n  }\n}\n","export const cacheExpiryTolerance = 10 * 60; // 10 minutes (in seconds)\nexport const defaultAuthEndpoint = \"/feeds/tokens\";\nexport const feedIdRegex = /^[a-zA-Z0-9-]+$/;\nexport const instanceIdRegex = /^v([1-9][0-9]*):([a-zA-Z0-9-]+):([a-zA-Z0-9-]+)$/;\nexport const tokenProviderTimeout = 30 * 1000; // 30 seconds (in ms)\n","import {\n  cacheExpiryTolerance,\n  defaultAuthEndpoint,\n  tokenProviderTimeout,\n} from \"./constants\";\n\nimport { urlEncode, unixTimeNow } from \"./utils\";\n\nexport default class TokenProvider {\n  constructor({ authEndpoint, authData }) {\n    this.authEndpoint = authEndpoint || defaultAuthEndpoint;\n    this.authData = authData;\n  }\n\n  fetchToken() {\n    if (this.cacheIsStale) {\n      return this.makeAuthRequest().then(responseBody => {\n        this.cache(responseBody.access_token, responseBody.expires_in);\n        return this.cachedToken;\n      });\n    }\n    return Promise.resolve(this.cachedToken);\n  }\n\n  get cacheIsStale() {\n    return !this.cachedToken || unixTimeNow() > this.cacheValidUntil;\n  }\n\n  cache(token, expiresIn) {\n    this.cachedToken = token;\n    this.cacheValidUntil = unixTimeNow() + expiresIn - cacheExpiryTolerance;\n  }\n\n  makeAuthRequest() {\n    return new Promise((resolve, reject) => {\n      const xhr = new XMLHttpRequest();\n      xhr.open(\"POST\", this.authEndpoint);\n      xhr.timeout = tokenProviderTimeout;\n      xhr.onload = () => {\n        if (xhr.status === 200) {\n          resolve(JSON.parse(xhr.responseText));\n        } else {\n          reject(new Error(`Couldn't fetch token from ${\n            this.authEndpoint\n          }; got ${ xhr.status } ${ xhr.statusText }.`));\n        }\n      };\n      xhr.ontimeout = () => {\n        reject(new Error(`Request timed out while fetching token from ${\n          this.authEndpoint\n        }`));\n      }\n      xhr.setRequestHeader(\"content-type\", \"application/x-www-form-urlencoded\");\n      xhr.send(urlEncode({\n        ...this.authData,\n        grant_type: \"client_credentials\",\n      }));\n    });\n  }\n}\n","import PusherPlatform from \"pusher-platform\";\nimport Feed from \"./feed\";\nimport TokenProvider from \"./token-provider\";\nimport { feedIdRegex, instanceIdRegex } from \"./constants\";\nimport { parseResponse, queryString } from \"./utils\";\n\nexport default class Feeds {\n  constructor({\n    authData = {},\n    authEndpoint,\n    host,\n    instanceId,\n    logLevel,\n    logger,\n  } = {}) {\n    this.authData = authData;\n    this.authEndpoint = authEndpoint;\n    if (!instanceId || !instanceId.match(instanceIdRegex)) {\n      throw new TypeError(`Invalid instanceId: ${ instanceId }`);\n    }\n    this.listTokenProvider = new TokenProvider({\n      authEndpoint: this.authEndpoint,\n      authData: {\n        ...this.authData,\n        path: \"feeds\",\n        action: \"READ\",\n      }\n    });\n    this.firehoseTokenProvider = new TokenProvider({\n      authEndpoint: this.authEndpoint,\n      authData: {\n        ...this.authData,\n        path: \"firehose/items\",\n        action: \"READ\",\n      }\n    });\n    if (!logger && logLevel) {\n      logger = new PusherPlatform.ConsoleLogger(logLevel);\n    }\n    this.instance = new PusherPlatform.Instance({\n      host,\n      instanceId,\n      logger,\n      serviceName: \"feeds\",\n      serviceVersion: \"v1\",\n    });\n  }\n\n  list({ prefix, limit } = {}) {\n    return parseResponse(this.instance.request({\n      method: \"GET\",\n      path: \"feeds\" + queryString({ prefix, limit }),\n      tokenProvider: this.listTokenProvider,\n    }));\n  }\n\n  feed(feedId) {\n    if (!feedId || !feedId.match(feedIdRegex)) {\n      throw new TypeError(`Invalid feedId: ${ feedId }`);\n    }\n    const readTokenProvider = feedId.startsWith(\"private-\") ? new TokenProvider({\n      authEndpoint:  this.authEndpoint,\n      authData: {\n        ...this.authData,\n        path: `feeds/${ feedId }/items`,\n        action: \"READ\",\n      }\n    }) : null;\n    return new Feed({\n      instance: this.instance,\n      feedId,\n      readTokenProvider,\n    });\n  }\n\n  firehose({ onPublish, onSubscribe, onUnsubscribe, ...options } = {}) {\n    validateFirehoseCallbacks({ onPublish, onSubscribe, onUnsubscribe });\n    const onEvent = event => {\n      if (event.body.event_type === 0 && onPublish) {\n        onPublish(event);\n      } else if (event.body.event_type === 1 && onSubscribe) {\n        onSubscribe(event);\n      } else if (event.body.event_type === 2 && onUnsubscribe) {\n        onUnsubscribe(event);\n      }\n    };\n    return this.instance.subscribe({\n      ...options,\n      onEvent,\n      path: \"firehose/items\",\n      tokenProvider: this.firehoseTokenProvider,\n    });\n  }\n}\n\nfunction validateFirehoseCallbacks(callbacks) {\n  const defined = Object.keys(callbacks)\n    .filter(k => callbacks[k] !== undefined)\n    .map(k => ({ name: k, callback: callbacks[k] }));\n  defined.forEach(({ name, callback }) => {\n    if (typeof callback !== \"function\") {\n      throw new TypeError(`${ name } must be a function, got ${ callback }`);\n    }\n  });\n  if (defined.length === 0) {\n    throw new TypeError(`Must provide at least one of onPublish, onSubscribe, or onUnsubscribe`);\n  }\n}\n"],"names":["webpackUniversalModuleDefinition","root","factory","module","this","modules","installedModules","__webpack_require__","moduleId","exports","i","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","getDefault","getModuleExports","object","property","prototype","hasOwnProperty","p","s","__extends","extendStatics","setPrototypeOf","__proto__","Array","b","__","constructor","create","logger_1","resumable_subscription_1","retry_strategy_1","stateless_subscription_1","responseHeadersObj","headerStr","headers","headerPairs","split","length","headerPair","index","indexOf","key","substring","val","ErrorResponse","_super","statusCode","info","_this","JSON","stringify","fromXHR","xhr","status","getAllResponseHeaders","responseText","Error","NetworkError","error","XhrReadyState","BaseClient","options","host","replace","baseURL","encrypted","XMLHttpRequest","window","logger","ConsoleLogger","request","createXHR","Promise","resolve","reject","onreadystatechange","readyState","send","body","newStatelessSubscription","subOptions","method","retryStrategy","ExponentialBackoffRetryStrategy","StatelessSubscription","path","newResumableSubscription","ResumableSubscription","endpoint","open","toUpperCase","setRequestHeader","jwt","LogLevel","threshold","log","logFunction","level","message","loggerSignature","group","groupEnd","verbose","console","VERBOSE","debug","DEBUG","INFO","warn","WARNING","ERROR","EmptyLogger","RetryingTokenProvider","baseTokenProvider","fetchToken","tryFetching","invalidateToken","token","then","catch","checkIfRetryable","NoOpTokenProvider","undefined","FixedTokenProvider","token_provider_1","base_subscription_1","xhrSource","lastEventIdReceived","lastEventId","tokenProvider","replaceUnimplementedListenersWithNoOps","tryNow","newXhr","baseSubscription","BaseSubscription","onOpen","reset","event","onEvent","eventId","onEnd","onRetry","onError","unsubscribe","cancel","base_client_1","Retry","waitTimeMillis","DoNotRetry","retryUnsafeRequests","limit","retryCount","maxBackoffMillis","defaultBackoffMillis","currentBackoffMillis","pendingTimeouts","Set","requestMethod","initialBackoffMillis","shouldRetry","timeout_1","setTimeout","delete","add","forEach","timeout","clearTimeout","requestMethodIsSafe","parseInt","shouldSafeRetry","calulateMillisToRetry","SubscriptionState","state","UNOPENED","lastNewlineIndex","gotEOS","UNSENT","OPENED","HEADERS_RECEIVED","assertStateIsIn","OPENING","LOADING","onLoading","DONE","onDone","ENDED","abort","OPEN","ENDING","err","onChunk","response","newlineIndex","lastIndexOf","rawEvents","slice","_i","rawEvents_1","rawEvent","data","parse","onMessage","verifyMessage","onEventMessage","onEOSMessage","eventMessage","_","id","isArray","eosMessage","validStates","arguments","stateIsValid","some","validState","expectedStates","map","join","actualState","__assign","assign","t","HOST_BASE","Instance","instanceId","serviceName","serviceVersion","splitInstance","platformVersion","cluster","client","absPath","subscribe","subscription","resumableSubscribe","resumableSubscription","relativePath","default","instance_1","parseResponse","promise","urlEncode","keys","filter","encodeURIComponent","queryString","encodedData","unixTimeNow","Math","floor","Date","now","Feed","instance","feedId","readTokenProvider","onItem","TypeError","lastItemId","previousItems","cursor","cacheExpiryTolerance","defaultAuthEndpoint","feedIdRegex","instanceIdRegex","tokenProviderTimeout","TokenProvider","authEndpoint","authData","cacheIsStale","makeAuthRequest","cache","responseBody","access_token","expires_in","cachedToken","expiresIn","cacheValidUntil","onload","statusText","ontimeout","Feeds","logLevel","match","listTokenProvider","firehoseTokenProvider","PusherPlatform","prefix","startsWith","onPublish","onSubscribe","onUnsubscribe","event_type","validateFirehoseCallbacks","callbacks","defined","k","callback"],"mappings":"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"}